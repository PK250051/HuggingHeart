// assets/js/chat-engine.js

async function botResponse(text) {
    const status = document.getElementById('typing-status');
    const display = document.getElementById('chat-display');

    // 1. Show Typing Status
    status.innerText = "Luna is typing...";
    
    // 2. Short Delay (Simulation)
    await new Promise(resolve => setTimeout(resolve, 1000));

    // 3. Create Message Container
    const msgDiv = document.createElement('div');
    msgDiv.className = "bot-msg";
    display.appendChild(msgDiv);
    
    status.innerText = "Online"; // Reset status

    // 4. Show Word-by-Word
    const words = text.split(" ");
    for (let i = 0; i < words.length; i++) {
        msgDiv.innerHTML += words[i] + " ";
        display.scrollTop = display.scrollHeight;
        await new Promise(resolve => setTimeout(resolve, 100)); // Delay per word
    }
}

function handleTyping(val) {
    const box = document.getElementById('suggestion-box');
    if (val.length >= 2) {
        // Search in PQ_Master_List.csv logic
        const matches = suggestions.filter(q => q.toLowerCase().includes(val.toLowerCase())).slice(0, 3);
        if (matches.length > 0) {
            box.innerHTML = matches.map(m => `<div class="suggestion-item" onclick="selectSuggestion('${m}')">${m}</div>`).join('');
            box.style.display = 'block';
        }
    } else {
        box.style.display = 'none';
    }
}
